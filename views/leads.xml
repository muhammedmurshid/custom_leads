<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <record model="ir.actions.act_window" id="action_leads_main_action">
        <field name="name">Leads</field>
        <field name="res_model">leads.logic</field>
        <field name="view_mode">kanban,tree,form</field>
    </record>
    <record model="ir.actions.act_window" id="action_leads_deals_action">
        <field name="name">Deals</field>
        <field name="res_model">leads.logic</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state', '=', 'deal')]</field>
    </record>
    <record model="ir.actions.act_window" id="action_leads_admission_action">
        <field name="name">Admission</field>
        <field name="res_model">leads.logic</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state', '=', 'qualified')]</field>
    </record>
    <record id="tree_view_leads_logic" model="ir.ui.view">
        <field name="name">leads.logic.view.tree</field>
        <field name="model">leads.logic</field>
        <field name="arch" type="xml">
            <tree>
                <field name="reference_no"/>
                <field name="date_of_adding" string="Added Date" widget="badge"/>
                <field name="name"/>
                <field name="phone_number" string="Mobile" widget="phone"/>
                <field name="phone_number_second" string="Phone" widget="phone"/>
                <field name="email_address" string="Email" widget="mail"/>
                <field name="lead_quality" widget="badge"/>
                <field name="lead_owner"/>
                <field name="tele_caller_id"/>
                <field name="create_uid"/>
                <field name="admission_status"/>
                <field name="state" decoration-info="state == 'new'"
                       decoration-success="state == 'qualified'"
                       decoration-danger="state == 'lost'" decoration-primary="state == 'in_progress'" widget="badge"/>
            </tree>
        </field>
    </record>
    <record id="form_view_leads_logic" model="ir.ui.view">
        <field name="name">leads.logic.view.form</field>
        <field name="model">leads.logic</field>
        <field name="arch" type="xml">
            <form string="Leads">
                <style>

                </style>

                <header>
                    <field name="state" widget="statusbar"/>
                    <button name="act_attempt_to_connect" type="object" string="Attempted to Contact"
                            class="btn btn-primary me-1" invisible="state != 'new'"/>
                    <button name="act_convert" type="object" string="Convert"
                            class="btn-convert" invisible="state in ['qualified','new','lost','deal']"/>
                    <button name="act_admission" type="object" string="Admission"
                            class="btn-convert" invisible="state != 'deal'"/>
                    <button name="act_lost_lead" type="object" string="Lost"
                            class="btn-lost" invisible="state in ['lost','qualified']"/>
                    <button name="act_return_to_new_lead" type="object" string="Return to New Lead"
                            class="btn-lost" invisible="state != 'lost'"/>
                    <!--                    <button name="act_not_connected" type="object" string="Not Connected"/>-->
                    <!--                                   <button string="Cancel" class="btn-default" special="cancel"/>-->
                </header>
                <sheet>
                    <group>
                        <field name="current_status" readonly="1" widget="badge"
                               decoration-info="current_status == 'not_responding'"
                               decoration-primary="current_status == 'new_lead'"/>
                        <field name="transitions" invisible="current_status != 'need_follow_up'"/>
                        <button
                                name="act_connected"
                                type="object"
                                string="Connected"
                                class="btn-connected" invisible="state != 'in_progress'"/>
                        <button
                                name="act_not_connected"
                                type="object"
                                string="Not Connected"
                                class="btn-not-connected" invisible="state != 'in_progress'"/>
                        <button name="act_call_back" type="object" string="Call Back"
                                invisible="state != 'not_connected'" class="btn-call-back"/>
                    </group>
                </sheet>
                <sheet>
                    <widget name="web_ribbon" title="Lost" bg_color="text-bg-danger" invisible="state != 'lost'"/>
                    <widget name="web_ribbon" title="Qualified" bg_color="text-bg-success"
                            invisible="state != 'qualified'"/>
                    <h2>
                        <field name="reference_no" invisible="state == 'new'" widget="badge"/>
                    </h2>
                    <group>
                        <field name="name" style="background-color:#fae7e3;"/>
                        <field name="email_address"/>
                        <field name="phone_number" style="background-color:#fae7e3;"/>

                    </group>
                </sheet>
                <sheet>
                    <!--                    <widget name="web_ribbon" title="Lost" bg_color="text-bg-danger" invisible="state != 'lost'"/>-->
                    <!--                    <widget name="web_ribbon" title="Qualified" bg_color="text-bg-success"-->
                    <!--                            invisible="state != 'qualified'"/>-->

                    <!--                    <h2>-->
                    <!--                        <field name="reference_no" invisible="state == 'new'" widget="badge"/>-->
                    <!--                    </h2>-->
                    <group>
                        <group string="Lead Information">
                            <!--                            <field name="name"/>-->
                            <!--                            <field name="email_address"/>-->
                            <!--                            <field name="phone_number"/>-->
                            <field name="phone_number_second"/>
                            <field name="parent_number"/>
                            <field name="leads_source" style="background-color:#fae7e3;" options="{'no_create':True}"/>
                            <field name="incoming_source_checking" invisible="1"/>
                            <field name="digital_lead" invisible="1"/>
                            <field name="incoming_source" invisible="incoming_source_checking != 1"/>
                            <field name="digital_lead_source" invisible="digital_lead != 1"/>
                            <field name="mode_of_study"/>
                            <field name="lead_status"/>

                        </group>
                        <group name="info" string="">
                            <field name="lead_quality" style="background-color:#fae7e3;"/>
                            <field name="lead_type"/>
                            <field name="call_response"/>
                            <field name="crash_user_id" invisible="lead_quality != 'crash_lead'"/>
                            <field name="updated_remarks" invisible="lead_quality != 'bad_lead'"/>
                            <field name="not_response_note" invisible="lead_quality != 'not_responding'"/>
                            <!--                            <field name="lead_status"/>-->
                            <field name="country"/>
                            <field name="district" style="background-color:#fae7e3;"/>
                            <field name="place"/>
                            <field name="campaign"/>
                            <field name="amount" invisible="state in ['new','in_progress']"/>
                            <!--                            <field name="leads_assign"/>-->
                        </group>
                        <group name="users" string="Users">
                            <field name="create_uid"/>
                            <field name="lead_owner"/>
                            <field name="tele_caller_id"/>
                        </group>
                        <group string="Course Details">
                            <field name="academic_year"/>
                            <field name="course_type"/>
                            <field name="course_interested"/>
                        </group>
                        <group string="Admission Details">
                            <field name="admission_status"/>
                            <field name="booking_amount" readonly="1"/>
                        </group>
                        <group>
                            <!--                            <field name="referred_by"/>-->
                            <!--                            <field name="lead_referral_staff_id"/>-->

                            <!--                            <field name="platform"/>-->
                            <!--                            <field name="remarks"/>-->

                        </group>
                        <group string="Educational Details">
                            <field name="title"/>
                            <field name="college_name"/>
                            <field name="last_studied_course"/>
                            <field name="academic_year_of_course_attend"/>

                        </group>
                        <group string="Course -Branch-Batch">
                            <field name="course_id" options="{'no_quick_create': True, 'no_create_edit' : True}"
                                   style="background-color:#fae7e3;"/>
                            <field name="branch_id" options="{'no_quick_create': True, 'no_create_edit' : True}"
                                   style="background-color:#fae7e3;"/>
                            <field name="batch_id" options="{'no_quick_create': True, 'no_create_edit' : True}"
                                   style="background-color:#fae7e3;"/>
                        </group>
                        <group string="Dates">
                            <field name="date_of_adding"/>
                            <field name="last_update_date"/>
                            <field widget="badge" name="expected_joining_date"
                                   invisible="lead_quality not in ['warm','hot']"/>
                            <field name="closing_date" invisible="state != 'deal'"/>
                            <field name="admission_date" invisible="state != 'qualified'"/>
                        </group>

                        <group name="lost_reason" string="Lost Reason" invisible="state != 'lost'">
                            <field name="lost_reason" style="background-color:#f54720 color:white;"/>
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids" options="{'post_refresh': 'recipients'}"/>
                </div>
            </form>
        </field>
    </record>

    <record id="logic_leads_kanban_view_odoo" model="ir.ui.view">
        <field name="name">leads.logic.kanban</field>
        <field name="model">leads.logic</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" default_group_by="lead_quality" default_order="date_of_adding desc"
                    archivable="false"
                    sample="1" quick_create="0">
                <field name="lead_quality" default_order="lead_quality"
                />
                <progressbar field="lead_quality"
                             colors='{"new": "primary", "waiting_for_admission": "info", "admission": "success", "bad_lead": "danger", "cold":"warning", "hot":"secondary", "warm":"secondary"}'/>


                <!--                <progressbar field="state"-->
                <!--                             colors='{"completed": "success", "in_progress": "warning", "cancelled": "secondary","hold":"info"}'/>-->
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_content oe_kanban_global_click" class="o_kanban_box">
                            <div class="o_kanban_record_body">
                                <span class="float-right text-right">
                                    <!--                                    <field name="badge" widget="label_selection"-->
                                    <!--                                           options="{'classes': {'bronze': 'info', 'silver': 'primary', 'gold': 'success'}}"/>-->
                                </span>
                            </div>
                            <div>

                                <strong class="o_kanban_record_title">
                                    <span>
                                        <b>Name :</b>
                                        <field name="name"/>
                                        <br/>
                                    </span>
                                </strong>
                            </div>
                            <div class="o_kanban_record_body">

                                <span>
                                    <b>Source :</b>
                                    <field name="leads_source"/>
                                    <br/>
                                </span>
                                <span>
                                    <b>Mobile :</b>
                                    <field name="phone_number" widget="phone" class="hover-field-value"/>
                                    <br/>
                                </span>


                                <span>
                                    <b>Lead Owner :</b>
                                    <field name="lead_owner"/>
                                    <!--                                    <field name="lead_owner" widget="many2one_avatar_employee"/>-->
                                    <br/>
                                </span>
                                <span>
                                    <b>Response :</b>
                                    <span class="hover-text">
                                        <field name="truncated_call_response"/>
                                        <span class="full-response">
                                            <field name="call_response"/>
                                        </span>
                                    </span>
                                    <br/>
                                </span>


                                <span>
                                    <b>Updated DateTime :</b>
                                    <field name="last_update_date" widget="badge"/>
                                    <br/>
                                </span>
                            </div>
                            <div class="o_kanban_record_bottom d-flex justify-content-between">
                                <div>
                                    <field name="activity_ids" widget="kanban_activity"/>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <field name="lead_owner" widget="many2one_avatar_employee"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <record id="ir_sequence_leads_logic" model="ir.sequence">
        <field name="name">Leads Sequence</field>
        <field name="code">leads.logic</field>
        <field name="prefix">LS</field>
        <field name="padding">3</field>
        <field name="company_id" eval="False"/>
    </record>
    <record model="ir.actions.act_window" id="lead_activity_view_action">
        <field name="name">Leads Activity</field>
        <field name="res_model">mail.activity</field>
        <field name="view_mode">tree,form,calendar</field>
        <field name="domain">[('res_model', '=', 'leads.logic')]</field>
    </record>
    <menuitem id="leads_main_menu"
              name="Leads"
              web_icon="custom_leads,static/description/icon.png"/>
    <menuitem
            id="leads_sub_menu"
            name="Leads"
            parent="leads_main_menu"
            sequence="1"
            action="action_leads_main_action"/>
    <menuitem
            id="leads_activity_menu"
            name="Tasks"
            parent="leads_main_menu"
            sequence="10"
            action="lead_activity_view_action"/>
    <menuitem
            id="leads_deals_menu"
            name="Deals"
            parent="leads_main_menu"
            sequence="2"
            action="action_leads_deals_action"/>
    <menuitem
            id="leads_configuration_menu"
            name="Configuration"
            parent="leads_main_menu"
            sequence="10"
    />
    <menuitem
            id="leads_admission_menu"
            name="Admission"
            parent="leads_main_menu"
            sequence="4"
            action="action_leads_admission_action"/>
</odoo>